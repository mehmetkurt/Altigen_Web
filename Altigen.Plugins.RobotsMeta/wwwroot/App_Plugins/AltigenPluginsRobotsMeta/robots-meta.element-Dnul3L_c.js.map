{"version":3,"file":"robots-meta.element-Dnul3L_c.js","sources":["../../../Client/src/property-editor/robots-meta.element.ts"],"sourcesContent":["import { LitElement, html, css, customElement, property } from \"@umbraco-cms/backoffice/external/lit\";\r\nimport { UmbElementMixin } from \"@umbraco-cms/backoffice/element-api\";\r\n\r\n// DİKKAT: 'export class' yerine 'export default class' yazıyoruz.\r\n@customElement('altigen-robots-meta')\r\nexport default class AltigenRobotsMetaElement extends UmbElementMixin(LitElement) {\r\n\r\n    @property({ type: Array })\r\n    public value: string[] = [];\r\n\r\n    @property({ attribute: false })\r\n    public config: any;\r\n\r\n    private _options: Array<{ label: string, value: string }> = [];\r\n    private _exclusionRules: Record<string, string[]> = {};\r\n    private _inclusionRules: Record<string, string[]> = {};\r\n\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        this._initOptions();\r\n        this._initExclusionRules();\r\n        this._initInclusionRules();\r\n        this._initDefaultValue();\r\n    }\r\n\r\n    private _initExclusionRules() {\r\n        if (this.config?.exclusionRules) {\r\n            const lines = this.config.exclusionRules.split('\\n');\r\n            lines.forEach((line: string) => {\r\n                const parts = line.split('>');\r\n                if (parts.length === 2) {\r\n                    const trigger = parts[0].trim();\r\n                    const excluded = parts[1].split(',').map(s => s.trim());\r\n                    this._exclusionRules[trigger] = excluded;\r\n                }\r\n            });\r\n        } else {\r\n            // Default rules if not configured\r\n            this._exclusionRules = {\r\n                \"index\": [\"noindex\"],\r\n                \"noindex\": [\"index\"]\r\n            };\r\n        }\r\n    }\r\n\r\n    private _initInclusionRules() {\r\n        if (this.config?.inclusionRules) {\r\n            const lines = this.config.inclusionRules.split('\\n');\r\n            lines.forEach((line: string) => {\r\n                const parts = line.split('>');\r\n                if (parts.length === 2) {\r\n                    const trigger = parts[0].trim();\r\n                    const included = parts[1].split(',').map(s => s.trim());\r\n                    this._inclusionRules[trigger] = included;\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    private _initOptions() {\r\n        if (this.config?.options) {\r\n            const lines = this.config.options.split('\\n');\r\n            this._options = lines.map((line: string) => {\r\n                const parts = line.split('|');\r\n                return {\r\n                    label: parts[0].trim(),\r\n                    value: parts.length > 1 ? parts[1].trim() : parts[0].trim()\r\n                };\r\n            }).filter((opt: { label: string, value: string }) => opt.value);\r\n        } else {\r\n            // Default options if not configured\r\n            this._options = [\r\n                { label: \"Index\", value: \"index\" },\r\n                { label: \"No Index\", value: \"noindex\" },\r\n                { label: \"Nofollow\", value: \"nofollow\" },\r\n                { label: \"No Archive\", value: \"noarchive\" },\r\n                { label: \"No Image Index\", value: \"noimageindex\" },\r\n                { label: \"No Snippet\", value: \"nosnippet\" }\r\n            ];\r\n        }\r\n    }\r\n\r\n    private _initDefaultValue() {\r\n        if ((!this.value || this.value.length === 0) && this.config?.defaultValues) {\r\n            this.value = this.config.defaultValues.split(',').map((v: string) => v.trim()).filter((v: string) => v);\r\n            this.dispatchEvent(new CustomEvent('property-value-change', {\r\n                detail: { value: this.value },\r\n                bubbles: true,\r\n                composed: true,\r\n            }));\r\n        }\r\n    }\r\n\r\n    private _handleChange(e: Event, optionValue: string) {\r\n        const checkbox = e.target as HTMLInputElement;\r\n        const isChecked = checkbox.checked;\r\n\r\n        let newValue = this.value ? [...this.value] : [];\r\n\r\n        if (isChecked) {\r\n            // Apply exclusion rules\r\n            if (this._exclusionRules[optionValue]) {\r\n                const excludedValues = this._exclusionRules[optionValue];\r\n                newValue = newValue.filter(v => !excludedValues.includes(v));\r\n            }\r\n\r\n            // Apply inclusion rules\r\n            if (this._inclusionRules[optionValue]) {\r\n                const includedValues = this._inclusionRules[optionValue];\r\n                includedValues.forEach(val => {\r\n                    if (!newValue.includes(val)) {\r\n                        newValue.push(val);\r\n                    }\r\n                    // Also apply exclusions for the included values (recursive-like but just one level for now)\r\n                    if (this._exclusionRules[val]) {\r\n                         const recursiveExcluded = this._exclusionRules[val];\r\n                         newValue = newValue.filter(v => !recursiveExcluded.includes(v));\r\n                    }\r\n                });\r\n            }\r\n\r\n            if (!newValue.includes(optionValue)) {\r\n                newValue.push(optionValue);\r\n            }\r\n        } else {\r\n            newValue = newValue.filter(v => v !== optionValue);\r\n        }\r\n\r\n        this.value = newValue;\r\n\r\n        this.dispatchEvent(new CustomEvent('property-value-change', {\r\n            detail: { value: this.value },\r\n            bubbles: true,\r\n            composed: true,\r\n        }));\r\n\r\n        this.requestUpdate();\r\n    }\r\n\r\n    render() {\r\n        return html`\r\n            <div class=\"options-container\">\r\n                ${this._options.map(opt => html`\r\n                    <uui-checkbox \r\n                        .checked=\"${this.value?.includes(opt.value) ?? false}\" \r\n                        @change=\"${(e: Event) => this._handleChange(e, opt.value)}\"\r\n                        label=\"${opt.label}\">\r\n                        ${opt.label}\r\n                    </uui-checkbox>\r\n                `)}\r\n            </div>\r\n        `;\r\n    }\r\n\r\n    static styles = css`\r\n        .options-container {\r\n            display: flex;\r\n            flex-direction: column;\r\n            gap: 10px;\r\n        }\r\n    `;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        'altigen-robots-meta': AltigenRobotsMetaElement;\r\n    }\r\n}"],"names":["AltigenRobotsMetaElement","UmbElementMixin","LitElement","line","parts","trigger","excluded","s","included","lines","opt","v","e","optionValue","isChecked","newValue","excludedValues","val","recursiveExcluded","html","css","__decorateClass","property","customElement"],"mappings":"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"}